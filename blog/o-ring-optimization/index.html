<!doctype html><html lang=en-us><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-131142568-1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-131142568-1")</script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.js></script><meta charset=utf-8><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta name=viewport content="width=device-width,initial-scale=1"><title>O-Ring Optimization for FPL - AlpsCode</title><meta name=author content="Sertalp B. Cay"><meta name=keywords content="analytics,programming,optimization,FPL,math"><meta name=description content><meta name=generator content="Hugo 0.147.8"><link href='//fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,500,700,800' rel=stylesheet type=text/css><link rel=stylesheet href=//use.fontawesome.com/releases/v5.11.2/css/all.css><link rel=stylesheet href=//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css integrity=sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u crossorigin=anonymous><link href=/css/animate.css rel=stylesheet><link href=/css/style.default.css rel=stylesheet id=theme-stylesheet><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel="shortcut icon" href=/img/favicon.ico type=image/x-icon><link rel=apple-touch-icon href=/img/apple-touch-icon.png><link href=/css/owl.carousel.css rel=stylesheet><link href=/css/owl.theme.css rel=stylesheet><link rel=alternate href=https://alpscode.com/index.xml type=application/rss+xml title=AlpsCode><meta property="og:locale" content="en_us"><meta property="og:site_name" content="AlpsCode"><meta property="og:title" content="O-Ring Optimization for FPL"><meta property="og:type" content="article"><meta property="og:url" content="https://alpscode.com/blog/o-ring-optimization/"><meta property="og:description" content><meta property="og:image" content="https://alpscode.com/img/banners/pexels-pixabay-73871.jpg"><meta property="og:image:type" content="image/jpg"><meta property="og:image:width" content="640"><meta property="og:image:height" content="428"><meta property="og:updated_time" content="2021-01-12T11:30:00-0400"><meta property="article:section" content="optimization"><meta property="article:tag" content="FPL"><meta property="article:tag" content="optimization"><meta property="article:tag" content="analytics"><meta property="article:tag" content="math"><meta property="article:published_time" content="2021-01-12T11:30:00-0400"><meta property="article:modified_time" content="2021-01-12T11:30:00-0400"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="O-Ring Optimization for FPL"><meta name=twitter:image content="https://alpscode.com/img/banners/pexels-pixabay-73871.jpg"><meta name=twitter:description content><script type=text/javascript>var _paq=_paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){t="//alpscode.com/piwik/",_paq.push(["setTrackerUrl",t+"piwik.php"]),_paq.push(["setSiteId","1"]);var t,n=document,e=n.createElement("script"),s=n.getElementsByTagName("script")[0];e.type="text/javascript",e.async=!0,e.defer=!0,e.src=t+"piwik.js",s.parentNode.insertBefore(e,s)}()</script><script src=https://cdn.jsdelivr.net/npm/vanilla-lazyload@10.19.0/dist/lazyload.min.js></script><link href=/css/syntax.css rel=stylesheet><link href=/css/custom.css rel=stylesheet><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]]}}</script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script></head><body><div id=all><header><header class=navbar-affixed-top data-spy=affix data-offset-top=62><div class="navbar navbar-default yamm" role=navigation id=navbar><div class=container><div class=navbar-header><a class="navbar-brand home" href=/><img src=/img/logo.svg alt="O-Ring Optimization for FPL logo" class="hidden-xs hidden-sm">
<img src=/img/logo.svg alt="O-Ring Optimization for FPL logo" class="visible-xs visible-sm">
<span class=sr-only>O-Ring Optimization for FPL - go to homepage</span></a><div class=navbar-buttons><button type=button class="navbar-toggle btn-template-main" data-toggle=collapse data-target=#navigation>
<span class=sr-only>Toggle Navigation</span>
<i class="fas fa-align-justify"></i></button></div></div><div class="navbar-collapse collapse" id=navigation><ul class="nav navbar-nav navbar-right"><li class="dropdown active"><a href=/blog/>Blog</a></li><li class=dropdown><a href=/about>About</a></li></ul></div><div class="collapse clearfix" id=search><form class=navbar-form role=search><div class=input-group><input type=text class=form-control placeholder=Search>
<span class=input-group-btn><button type=submit class="btn btn-template-main"><i class="fas fa-search"></i></button></span></div></form></div></div></div></header></header><div id=heading-breadcrumbs><div class=container><div class=row><div class=col-md-12><h1>O-Ring Optimization for FPL</h1></div></div></div></div><div id=content><div class=container><div class=row><div class=col-md-9 id=blog-post><p class="text-muted mb-small text-right">By <a href=/about>Sertalp B. Cay</a> | January 12, 2021</p><div class=post-header-img style=background-image:url(https://alpscode.com//img/banners/pexels-pixabay-73871.jpg)><div class=post-header-img-inner></div></div><div id=post-content><p>&ldquo;The Numbers Game&rdquo;<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> is a great read for anyone interested in football (soccer) analytics.
The book covers a wide range of events where numbers give insights to football professionals on topics like possession, short/long passes, and team evaluation.
I have recently read the section about the &ldquo;O-Ring theory&rdquo;, which brought a couple of new ideas regarding FPL.</p><p><em>O-Ring theory</em> says that a team (or a system) is as strong as its weakest link.
The idea itself is coming from the Space Shuttle <em>Challenger</em>, where the failure of O-ring seals caused the <a href=https://en.wikipedia.org/wiki/Space_Shuttle_Challenger_disaster target=_blank>catastrophic event in 1986</a>.
When applied to football, the theory points out that clubs should be improving (or replacing) their weakest players in the field, instead of focusing on superstars.</p><p>I have been talking about applying optimization to FPL for a while now, but this theory brings a whole new aspect to it.
I accept that the <em>O-Ring theory</em> does not make a lot of sense when thinking about FPL initially.
After all, our teams are not actually playing together.
However, we all have £100M (more or less) that we have to spend on a 15-players squad and our distribution of the budget determines our expected points.
It is tempting for managers to go after that shiny and expensive premium midfield, but it may force you to end up with a few players who has low expected points.
So, I will talk about how we can use optimization to have an FPL team where the weakest link is optimized.</p><h2 id=o-ring-model>O-Ring Model</h2><p>Before we go into details of the O-Ring model, let me point out the paper &ldquo;Testing the O-Ring theory using data from the English Premier League&rdquo;<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup> by Syzmanski and Wilkinson.
The paper concludes that the superstar theory is more effective than the O-Ring theory based on their study on EPL.
This might be the case for FPL as well, but the following models can still give you new ideas to improve your own models.</p><p>Quick note, mathematical details regarding following models are placed <a href=#technical-details>at the bottom of the post</a>.</p><p>In a typical FPL optimization model, our aim is to maximize the expected points (xP).
You are simply choosing 11 players out of over 600 players that will maximize your total xP.
If you maximize GW16 expected values (using <a href=https://fplreview.com/massive-data-planner/ target=_blank>FPL Review MD data</a>), you will get the following optimal team (under £100M budget).
This is our base model.</p><p><code>Pope, Robertson, Alexander-Arnold, Maguire, Alderweireld, Dier, Salah, Fernandes, Bamford, Adams, Kane</code> <sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup></p><figure class="ins-fig img-responsive"><img src=/img/uploads/fpl_optimized_oring_1.png class="lazy img-responsive pull-center"></figure><p>The total xP of this lineup is <strong>54.970</strong> (excluding captaincy).
As strange as it looks, this is indeed the optimal solution that maximizes the total xP.
However, it is curious how unbalanced and unorthodox the team looks with its 5-2-3 formation.
But it is valid!</p><p>The main logic of the O-Ring model is to assess a team with is worst player.
In this case, the worst player we have on the field is Pope &ndash; 4.04 xP.</p><p>In order to improve this lineup, suppose that you have decided to iterate over all the goalkeepers and found Lloris with 4.21 xP.
For the replacement, you need to check if you have enough budget.
Since GK is no longer the weakest link, you can focus the next one: Maguire with 4.10 xP.
You can iterate defenders, or maybe drop Maguire and get a midfield or perhaps a forward from the bench.
It should be obvious that the problem quickly spirals out of control.
There are simply too many possibilities to iterate.
This is where optimization comes into play and saves the day.</p><p>There is a definite answer to the question of <em>&ldquo;How much can we increase our worst player?&rdquo;</em>.
Or <em>&ldquo;What is the optimal lineup that will maximize the minimum xP I have on the field?&rdquo;</em>.
To answer this, we can write a &ldquo;maximin optimization&rdquo; model. (See details at the end)</p><p>Solving the problem will yield us the following lineup with xP of 52.17:</p><pre tabindex=0><code>Lloris
Robertson, Alexander-Arnold, Dier
Pulisic, Fernandes, Ward-Prowse, Son
Bamford, Firmino, Adams
</code></pre><p>Since we maximized the minimum xP on field, note that <em>this model does not care about the total xP at all</em>.
Minimum xP among all this 11 players is 4.19.
As our next step, we can use this value as a constraint in our base model (maximize lineup xP), forcing all players to have at least this much xP.
This method is called &ldquo;epsilon-constraint&rdquo;, where the optimal solution of a model is fed into the second model with a different objective.<sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup></p><p>By enforcing the minimum (O-Ring player) to have at least 4.19 xP and maximizing the lineup xP, we get the following solution:</p><pre tabindex=0><code>Lloris
Robertson, Alexander-Arnold, Dier
Pulisic, Salah, Ward-Prowse, Son
Werner, Bamford, Adams
</code></pre><p>Fernandes and Firmino out, Salah and Werner in. Total xP is <strong>53.448</strong>, and formation is 3-4-3. Not bad!
Our weakest link in the new lineup is Ward-Prowse &ndash; 4.19 xP.
See how the distribution of xPs change in the new lineup.</p><script>o_ring_data=[{web_name:"Lloris",points_md:4.218},{web_name:"Robertson",points_md:4.859},{web_name:"Alexander-Arnold",points_md:5.004},{web_name:"Dier",points_md:4.196},{web_name:"Pulisic",points_md:4.329},{web_name:"Salah",points_md:7.575},{web_name:"Ward-Prowse",points_md:4.19},{web_name:"Son",points_md:5.296},{web_name:"Werner",points_md:4.417},{web_name:"Bamford",points_md:5.155},{web_name:"Adams",points_md:4.209}],base_data=[{web_name:"Pope",points_md:4.035},{web_name:"Robertson",points_md:4.859},{web_name:"Alexander-Arnold",points_md:5.004},{web_name:"Maguire",points_md:4.099},{web_name:"Alderweireld",points_md:4.183},{web_name:"Dier",points_md:4.196},{web_name:"Salah",points_md:7.575},{web_name:"Fernandes",points_md:5.568},{web_name:"Bamford",points_md:5.155},{web_name:"Adams",points_md:4.209},{web_name:"Kane",points_md:6.087}]</script><div id=plot1></div><script type=text/javascript>$(document).ready(function(){var e,n,s={top:20,right:30,bottom:40,left:45},i=450-s.left-s.right,o=350-s.top-s.bottom;let h=d3.select("#plot1").append("svg").attr("viewBox",`0 0  ${i+s.left+s.right} ${o+s.top+s.bottom}`).attr("class","pull-center").style("display","block"),t=h.append("g").attr("transform","translate("+s.left+","+s.top+")");t.append("rect").attr("fill","#f1f1f1").attr("width",i).attr("height",o);let r=base_data.sort((e,t)=>e.points_md-t.points_md),c=o_ring_data.sort((e,t)=>e.points_md-t.points_md),l=base_data.map((e,t)=>[e,c[t]]),d=r.concat(c),f=Math.min(...d.map(e=>e.points_md))-.5,m=Math.max(...d.map(e=>e.points_md))+.5;e=d3.scaleBand().domain(r.map((e,t)=>t+1)).range([0,i]).padding([.3]),t.append("g").attr("transform","translate(0,"+o+")").call(d3.axisBottom(e)),n=d3.scaleLinear().domain([f,m]).range([o,0]),t.append("g").call(d3.axisLeft(n)),t.append("text").attr("text-anchor","middle").attr("x",i/2).attr("y",o+30).attr("font-size","7pt").text("Players (ordered by xP)"),t.append("text").attr("text-anchor","middle").attr("x",-5).attr("y",-5).attr("font-size","7pt").text("xP"),t.call(e=>e.selectAll(".tick").attr("font-size","6pt")),t.append("g").append("line").attr("x1",()=>e(0)).attr("x2",()=>e(11)+33).attr("y1",()=>n(4.19)).attr("y2",()=>n(4.19)).attr("stroke","black").attr("stroke-width","1px").attr("stroke-dasharray","4,3").attr("stroke-opacity",.3).attr("opacity",.7),t.append("g").selectAll().data(l).enter().append("line").attr("x1",(t,n)=>e(n+1)+e.bandwidth()/2).attr("x2",(t,n)=>e(n+1)+e.bandwidth()/2).attr("y1",(e)=>n(e[0].points_md)).attr("y2",(e)=>n(e[1].points_md)).attr("stroke","black").attr("stroke-width","2px").attr("opacity",.7),t.append("g").selectAll().data(r).enter().append("circle").attr("r",4).attr("cx",(t,n)=>e(n+1)+e.bandwidth()/2).attr("cy",e=>n(e.points_md)).attr("fill","blue").attr("stroke-width","0px").attr("opacity",.5),t.append("g").selectAll().data(c).enter().append("circle").attr("r",4).attr("cx",(t,n)=>e(n+1)+e.bandwidth()/2).attr("cy",e=>n(e.points_md)).attr("fill","red").attr("stroke-width","0px").attr("opacity",.5);let u=t.append("g").selectAll().data(l.map(e=>e.sort((e,t)=>e.points_md-t.points_md))).enter().append("g");u.append("text").attr("x",(t,n)=>e(n+1)+e.bandwidth()/2).attr("y",e=>n(e[0].points_md-.15)).text(e=>e[0].web_name).style("font-size","6px").attr("alignment-baseline","middle").attr("text-anchor","middle"),u.append("text").attr("x",(t,n)=>e(n+1)+e.bandwidth()/2).attr("y",e=>n(e[1].points_md+.15)).text(e=>e[1].web_name).style("font-size","6px").attr("alignment-baseline","middle").attr("text-anchor","middle");let a=t.append("g").attr("transform","translate("+10+","+10+")");a.append("circle").attr("cx",0).attr("cy",0).attr("r",3).style("fill","blue").attr("opacity",.5),a.append("text").attr("x",7).attr("y",1).text("Base Model").style("font-size","6px").attr("alignment-baseline","middle"),a.append("circle").attr("cx",50).attr("cy",0).attr("r",3).style("fill","red").attr("opacity",.5),a.append("text").attr("x",57).attr("y",1).text("O-Ring Model").style("font-size","6px").attr("alignment-baseline","middle")})</script><p>Compared to the base model, apparently the budget we gained from dropping Kane and Fernandes is used to upgrade low xP players: Pope, Maguire, Alderweireld.</p><h2 id=positional-o-ring-model>Positional O-Ring Model</h2><p>As you may have noticed, our new lineup has a very strong midfield setup.
Our total xP allocation for each position is as follows:</p><table><thead><tr><th>Total xP</th><th style=text-align:right>GK</th><th style=text-align:right>DF</th><th style=text-align:right>MD</th><th style=text-align:right>FW</th></tr></thead><tbody><tr><td>53.448</td><td style=text-align:right>4.218</td><td style=text-align:right>14.059</td><td style=text-align:right>21.390</td><td style=text-align:right>13.781</td></tr></tbody></table><p>Notice the total xP of MD and FW positions.
The lineup still feels unbalanced, even though we improved the weakest link.
This one is not unbalanced because of the formation (3-4-3 is quite balanced) but in terms of where we are expecting our points from.
We are expecting 21 points from midfields, while only 14 from forwards.</p><p>So what if we try to increase our FW expected points by dropping one of our premium midfields and upgrade one of our forwards.
We have another O-Ring model, but this time we are maximizing the minimum among total xPs of each position (excluding GK).
The objective is to &ldquo;maximize the minimum among total positional xP values&rdquo;.
We need to use the 2-stage optimization again as I have mentioned:</p><ol><li>Maximize the minimum of position xP totals (DF, MD, FW)</li><li>Maximize the lineup xP where total of each position is bounded below</li></ol><p>The first stage model finds that you can increase positional sum all the way up to 16.395.
After the second stage is completed, we have the following lineup:</p><pre tabindex=0><code>Lloris, 
Pieters, Alexander-Arnold, Maguire, Dier
Harrison, Salah, Fernandes
Bamford, Firmino, Kane
</code></pre><p>We have a 4-3-3 formation, with positional xP sums below.</p><table><thead><tr><th>Total xP</th><th style=text-align:right>GK</th><th style=text-align:right>DF</th><th style=text-align:right>MD</th><th style=text-align:right>FW</th></tr></thead><tbody><tr><td>54.454</td><td style=text-align:right>4.218</td><td style=text-align:right>16.826</td><td style=text-align:right>17.015</td><td style=text-align:right>16.395</td></tr></tbody></table><p>Notice that we are only 0.52 away from the overall optimal and have a very balanced squad now.
It worth mentioning that FPL has too many suboptimal solutions, and having multiple objectives help us to break ties.</p><script>type_names=["GK","DF","MD","FW"].slice(1),base_type_data=[4.035,22.341,13.143,15.451].slice(1),model2_type_data=[4.218,14.059,21.39,13.781].slice(1),model3_type_data=[4.218,16.826,17.015,16.395].slice(1)</script><div id=plot2></div><script type=text/javascript>$(document).ready(function(){var e,t,i,s={top:20,right:30,bottom:40,left:45},r=450-s.left-s.right,a=350-s.top-s.bottom;let h=d3.select("#plot2").append("svg").attr("viewBox",`0 0  ${r+s.left+s.right} ${a+s.top+s.bottom}`).attr("class","pull-center").style("display","block"),n=h.append("g").attr("transform","translate("+s.left+","+s.top+")");n.append("rect").attr("fill","#f1f1f1").attr("width",r).attr("height",a);let c=type_names.map((e,t)=>[e,base_type_data[t],model2_type_data[t],model3_type_data[t]]),l=base_type_data.concat(model2_type_data).concat(model3_type_data),u=Math.min(...l)-1,d=Math.max(...l)+2;t=d3.scaleBand().domain(type_names).range([0,r]).padding([.3]),n.append("g").attr("transform","translate(0,"+a+")").call(d3.axisBottom(t)),console.log(u),console.log(d),i=d3.scaleLinear().domain([u,d]).range([a,0]),n.append("g").call(d3.axisLeft(i)),n.append("text").attr("text-anchor","middle").attr("x",r/2).attr("y",a+30).attr("font-size","7pt").text("Positions"),n.append("text").attr("text-anchor","middle").attr("x",-5).attr("y",-5).attr("font-size","7pt").text("xP Sum"),n.call(e=>e.selectAll(".tick").attr("font-size","6pt")),n.append("g").selectAll().data(c).enter().append("line").attr("x1",e=>t(e[0])+t.bandwidth()/2).attr("x2",e=>t(e[0])+t.bandwidth()/2).attr("y1",(e)=>i(Math.min(...e.slice(1)))).attr("y2",(e)=>i(Math.max(...e.slice(1)))).attr("stroke","black").attr("stroke-width","2px").attr("opacity",.5),e=d3.symbol().size(50),n.append("g").selectAll().data(c).enter().append("path").attr("transform",(e)=>"translate("+(t(e[0])+t.bandwidth()/2)+", "+i(e[1])+")").attr("d",t=>(e.type(d3.symbolCircle),e())).attr("fill","blue").attr("opacity",.7),n.append("g").selectAll().data(c).enter().append("path").attr("transform",(e)=>"translate("+(t(e[0])+t.bandwidth()/2)+", "+i(e[2])+")").attr("d",t=>(e.type(d3.symbolSquare),e())).attr("fill","red").attr("opacity",.7),n.append("g").selectAll().data(c).enter().append("path").attr("transform",(e)=>"translate("+(t(e[0])+t.bandwidth()/2)+", "+i(e[3])+")").attr("d",t=>(e.type(d3.symbolTriangle),e())).attr("fill","orange").attr("opacity",.7);let o=n.append("g").attr("transform","translate("+10+","+10+")");o.append("rect").attr("transform","translate(185, -10)").attr("fill","darkgray").attr("width",180).attr("height",20).attr("opacity",.2),o.append("g").attr("transform","translate(195, -1)").append("path").attr("d",t=>(e.type(d3.symbolCircle),e())).attr("fill","blue").attr("opacity",.7),o.append("g").attr("transform","translate(203, 0)").append("text").attr("x",0).attr("y",0).text("Base Model").style("font-size","6px").attr("alignment-baseline","middle"),o.append("g").attr("transform","translate(250, -1)").append("path").attr("d",t=>(e.type(d3.symbolSquare),e())).attr("fill","red").attr("opacity",.7),o.append("g").attr("transform","translate(258, 0)").append("text").attr("x",0).attr("y",0).text("O-Ring Model").style("font-size","6px").attr("alignment-baseline","middle"),o.append("g").attr("transform","translate(305, 0)").append("path").attr("d",t=>(e.type(d3.symbolTriangle),e())).attr("fill","orange").attr("opacity",.7),o.append("g").attr("transform","translate(313, 0)").append("text").attr("x",0).attr("y",0).text("O-Ring Pos. Model").style("font-size","6px").attr("alignment-baseline","middle")})</script><p>As you see, our Positional O-Ring model expected values are much closer to each other than the base and O-Ring models.</p><h2 id=value-and-ownership>Value and Ownership</h2><p>FPL Review defines <em>value</em> as the total xP divided by the player&rsquo;s buy cost.
So, I wondered what if we try to maximize the minimum <em>value</em> in our lineup.</p><p>After the 2-stage optimization process, we get the following lineup:</p><pre tabindex=0><code>Lloris
Robertson, Alexander-Arnold, Maguire, Alderweireld, Dier
Harrison, Ward-Prowse, Raphinha
Bamford, Adams
</code></pre><p>This is quite an interesting team!
In the base model, lowest value among the lineup is 0.502.
The lowest value in the lineup above is 0.665!
Total xP, on the other hand, drops massively from 54.970 to 47.722.
Unfortunate.</p><p>There is another model with a weirder result.</p><p>Since I&rsquo;m pretty obsessed with ownership lately, I have tried maximizing the minimum ownership in the lineup.
This should force model to find <strong>the template</strong>.
I should mention that the player with the minimum ownership ratio in the original optimal solution is Alderweireld with 1.7%.</p><table><thead><tr><th>Name</th><th style=text-align:right>xP</th><th style=text-align:right>Ownership (%)</th></tr></thead><tbody><tr><td>Pope</td><td style=text-align:right>4.035</td><td style=text-align:right>10.1</td></tr><tr><td>Robertson</td><td style=text-align:right>4.859</td><td style=text-align:right>22.6</td></tr><tr><td>Alexander-Arnold</td><td style=text-align:right>5.004</td><td style=text-align:right>14.6</td></tr><tr><td>Maguire</td><td style=text-align:right>4.099</td><td style=text-align:right>3.4</td></tr><tr><td>Alderweireld</td><td style=text-align:right>4.183</td><td style=text-align:right>1.7</td></tr><tr><td>Dier</td><td style=text-align:right>4.196</td><td style=text-align:right>5.7</td></tr><tr><td>Salah</td><td style=text-align:right>7.575</td><td style=text-align:right>45.5</td></tr><tr><td>Fernandes</td><td style=text-align:right>5.568</td><td style=text-align:right>46.2</td></tr><tr><td>Bamford</td><td style=text-align:right>5.155</td><td style=text-align:right>46.9</td></tr><tr><td>Adams</td><td style=text-align:right>4.209</td><td style=text-align:right>9.5</td></tr><tr><td>Kane</td><td style=text-align:right>6.087</td><td style=text-align:right>42.1</td></tr></tbody></table><p>The O-Ring model for ownership ratio gives the following lineup.</p><table><thead><tr><th>Name</th><th style=text-align:right>xP</th><th style=text-align:right>Ownership (%)</th></tr></thead><tbody><tr><td>McCarthy</td><td style=text-align:right>3.604</td><td style=text-align:right>23.0</td></tr><tr><td>Zouma</td><td style=text-align:right>3.495</td><td style=text-align:right>27.1</td></tr><tr><td>Chilwell</td><td style=text-align:right>3.405</td><td style=text-align:right>24.2</td></tr><tr><td>Justin</td><td style=text-align:right>3.152</td><td style=text-align:right>25.8</td></tr><tr><td>Robertson</td><td style=text-align:right>4.859</td><td style=text-align:right>22.6</td></tr><tr><td>Grealish</td><td style=text-align:right>3.467</td><td style=text-align:right>41.8</td></tr><tr><td>Fernandes</td><td style=text-align:right>5.568</td><td style=text-align:right>46.2</td></tr><tr><td>Son</td><td style=text-align:right>5.296</td><td style=text-align:right>62.5</td></tr><tr><td>Calvert-Lewin</td><td style=text-align:right>3.235</td><td style=text-align:right>58.9</td></tr><tr><td>Bamford</td><td style=text-align:right>5.155</td><td style=text-align:right>46.9</td></tr><tr><td>Kane</td><td style=text-align:right>6.087</td><td style=text-align:right>42.1</td></tr></tbody></table><p>Well, as you see, the minimum ownership ratio of the players jumped from 1.7% to 22.6%.
You might be thinking that this lineup looks solid.
But the total xP actually fell even more. It is 47.323.</p><p>Yes, this 11 is worse than the &ldquo;poor man&rsquo;s value team&rdquo; with 47.722 total xP:</p><table><thead><tr><th>Name</th><th style=text-align:right>xP</th><th style=text-align:right>Ownership (%)</th></tr></thead><tbody><tr><td>Lloris</td><td style=text-align:right>4.218</td><td style=text-align:right>7.2</td></tr><tr><td>Robertson</td><td style=text-align:right>4.859</td><td style=text-align:right>22.6</td></tr><tr><td>Alexander-Arnold</td><td style=text-align:right>5.004</td><td style=text-align:right>14.6</td></tr><tr><td>Maguire</td><td style=text-align:right>4.099</td><td style=text-align:right>3.4</td></tr><tr><td>Alderweireld</td><td style=text-align:right>4.183</td><td style=text-align:right>1.7</td></tr><tr><td>Dier</td><td style=text-align:right>4.196</td><td style=text-align:right>5.7</td></tr><tr><td>Harrison</td><td style=text-align:right>3.872</td><td style=text-align:right>2.3</td></tr><tr><td>Ward-Prowse</td><td style=text-align:right>4.190</td><td style=text-align:right>17.6</td></tr><tr><td>Raphinha</td><td style=text-align:right>3.737</td><td style=text-align:right>1.5</td></tr><tr><td>Bamford</td><td style=text-align:right>5.155</td><td style=text-align:right>46.9</td></tr><tr><td>Adams</td><td style=text-align:right>4.209</td><td style=text-align:right>9.5</td></tr></tbody></table><h2 id=comparison-and-conclusion>Comparison and Conclusion</h2><p>It is time to list all the models we have seen for comparison purposes.</p><style>#final strong{color:darkred}</style><div id=final><table><thead><tr><th>Problem</th><th style=text-align:right>Total xP</th><th style=text-align:center>Pos. Total xP</th><th style=text-align:right>Min xP</th><th style=text-align:right>Min Value</th><th style=text-align:right>Min Own</th></tr></thead><tbody><tr><td>Base</td><td style=text-align:right><strong>54.970</strong></td><td style=text-align:center>[4.035, 22.341, 13.143, 15.451]</td><td style=text-align:right>4.035</td><td style=text-align:right>0.502</td><td style=text-align:right>1.7</td></tr><tr><td>O-Ring</td><td style=text-align:right>53.448</td><td style=text-align:center>[4.218, 14.059, 21.39, 13.781]</td><td style=text-align:right><strong>4.190</strong></td><td style=text-align:right>0.475</td><td style=text-align:right>2.5</td></tr><tr><td>Positional O-Ring</td><td style=text-align:right>54.454</td><td style=text-align:center>[4.218, 16.826, 17.015, <strong>16.395</strong>]</td><td style=text-align:right>3.527</td><td style=text-align:right>0.502</td><td style=text-align:right>0.3</td></tr><tr><td>Value O-Ring</td><td style=text-align:right>47.722</td><td style=text-align:center>[4.218, 22.341, 11.799, 9.364]</td><td style=text-align:right>3.737</td><td style=text-align:right><strong>0.665</strong></td><td style=text-align:right>1.5</td></tr><tr><td>Ownership O-Ring</td><td style=text-align:right>47.323</td><td style=text-align:center>[3.604, 14.911, 14.331, 14.477]</td><td style=text-align:right>3.152</td><td style=text-align:right>0.404</td><td style=text-align:right><strong>22.6</strong></td></tr></tbody></table></div><p>There is no clear winner, so it is up to your personal taste.
I think Positional O-Ring is pretty promising.</p><p>I have decided to put my FPL lineup where my mouth is.
My regular FPL model is a multi-period variant of the base model, but I have used Positional O-Ring for GW18 inside a 3-step process for the FH chip.
I switched from having an unbalanced 21/19/13 xP (5-3-2) to 17/17/18 (4-3-3) which decreased the overall xP by about 2 points.
I&rsquo;m curious to see if it will be a successful experiment.</p><figure class="ins-fig img-responsive"><img src=/img/uploads/fpl_gw18_squad.png class="lazy img-responsive pull-center"></figure><p>I&rsquo;m not sure how I&rsquo;ll proceed for the rest of the season.
Positional O-Ring produces a suboptimal solution where I have to lose a bit of an xP, but I can keep using it if the difference is small enough.
These models will be especially useful when I use my WC somewhere down the line.</p><p>It was an interesting exercise.
I could add some of these models (and their daily solutions) to FPL Optimized&rsquo;s &ldquo;<a href=https://sertalpbilal.github.io/fpl_optimized/week.html target=_blank>Optimal Squads</a>&rdquo; page if anyone is interested.
I am open to any feedback or suggestions.</p><hr><h2 id=technical-details>Technical Details</h2><p>Our base FPL Model maximizes the expected points, as follows:</p><script>MathJax={tex:{inlineMath:[["$","$"]]}}</script><p>$$
\text{maximize: } \sum_{e \in E} P_e \cdot x_e
$$</p><p>Here, $P$ is the expected points of player $e$ in the following gameweek, and $x$ is the binary value (1 if we have the player in our lineup, 0 otherwise).
This sum gives us the total xP of the lineup.</p><p>In order to apply the O-Ring idea, we need to use a &ldquo;maximin optimization&rdquo; model.
Our target now is to maximize the minimum xP in our lineup.
It looks like this:</p><p>$$
\text{maximize: } \min \left \{ P_e, e \in E : x_e=1 \right \}
$$</p><p>With a well-known trick, we can introduce variable $w$, maximize its value, while forcing everyone in the team to have a higher value:</p><p>\begin{align}
\text{maximize: } \; & w \\
\text{subject to: } \; & \dots \\
& w \leq P_e \cdot x_e + M \cdot (1-x_e) \quad \forall e \in E
\end{align}</p><p>Here, we are using the &ldquo;<a href=https://en.wikipedia.org/wiki/Big_M_method target=_blank>Big-M method</a>&rdquo; to force $w$ to be smaller than every player in our linuep.</p><p>Positional O-Ring model is quite similar and simpler.
We don&rsquo;t need the Big-M for this one:</p><p>\begin{align}
\text{maximize: } \; & w \\
\text{subject to: } \; & \dots \\
& w \leq \sum_{e \in E[t]} P_e \cdot x_e \quad \forall t \in T
\end{align}</p><p>Here, $T$ is the set of positions (DF, MD, FW), and $E[t]$ is the subset of all players for the specific position $t$.</p><p>See my source code and how I solve these problems using sasoptpy and CBC on <a href=https://github.com/sertalpbilal/fpl_optimized/blob/engine/src/working_problems.py target=_blank>GitHub</a>.</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>Anderson, Christopher, and David Sally. The numbers game: Why everything you know about soccer is wrong. Penguin, 2013. <a href=https://www.amazon.com/Numbers-Game-Everything-About-Soccer/dp/0143124560 target=_blank>(Amazon Link)</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>Szymanski, Stefan, and Guy Wilkinson. &ldquo;Testing the O-Ring theory using data from the English Premier League.&rdquo; Research in Economics 70.3 (2016): 468-481. <a href=https://www.sciencedirect.com/science/article/pii/S1090944316300904 target=_blank>(Science Direct Link)</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p>Optimal lineups/squads at <a href=https://sertalpbilal.github.io/fpl_optimized/week.html target=_blank>FPL Optimized</a> are generated 4 times everyday. You can go back in time and check old optimals.&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p>I have mentioned multiobjective optimization in the previous post, as well.
In that one we have used &ldquo;weighted-sum method&rdquo;.&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div></div><div class=col-md-3><div class="panel panel-default sidebar-menu"><div class=panel-heading><h3 class=panel-title>Search</h3></div><div class=panel-body><form action=//google.com/search method=get accept-charset=UTF-8 role=search><div class=input-group><input type=search name=q class=form-control placeholder=Search>
<input type=hidden name=sitesearch value=https://alpscode.com/>
<span class=input-group-btn><button type=submit class="btn btn-template-main"><i class="fas fa-search"></i></button></span></div></form></div></div><div class="panel panel-default sidebar-menu"><div class=panel-heading><h3 class=panel-title>Categories</h3></div><div class=panel-body><ul class="nav nav-pills nav-stacked"><li><a href=/categories/analytics>analytics (3)</a></li><li><a href=/categories/optimization>optimization (6)</a></li><li><a href=/categories/programming>programming (2)</a></li><li><a href=/categories/quick-tip>quick-tip (3)</a></li></ul></div></div><div class="panel sidebar-menu"><div class=panel-heading><h3 class=panel-title>Tags</h3></div><div class=panel-body><ul class=tag-cloud><li><a href=/tags/analytics><i class="fas fa-tags"></i> analytics</a></li><li><a href=/tags/api><i class="fas fa-tags"></i> api</a></li><li><a href=/tags/fantasy-premier-league><i class="fas fa-tags"></i> fantasy premier league</a></li><li><a href=/tags/fantasy-sports><i class="fas fa-tags"></i> fantasy sports</a></li><li><a href=/tags/fpl><i class="fas fa-tags"></i> fpl</a></li><li><a href=/tags/how-to><i class="fas fa-tags"></i> how-to</a></li><li><a href=/tags/latex><i class="fas fa-tags"></i> latex</a></li><li><a href=/tags/linux><i class="fas fa-tags"></i> linux</a></li><li><a href=/tags/machine-learning><i class="fas fa-tags"></i> machine learning</a></li><li><a href=/tags/math><i class="fas fa-tags"></i> math</a></li><li><a href=/tags/mathematics><i class="fas fa-tags"></i> mathematics</a></li><li><a href=/tags/optimization><i class="fas fa-tags"></i> optimization</a></li><li><a href=/tags/parsing><i class="fas fa-tags"></i> parsing</a></li><li><a href=/tags/predictive-modeling><i class="fas fa-tags"></i> predictive modeling</a></li><li><a href=/tags/python><i class="fas fa-tags"></i> python</a></li><li><a href=/tags/reddit><i class="fas fa-tags"></i> reddit</a></li><li><a href=/tags/rocket-league><i class="fas fa-tags"></i> rocket league</a></li><li><a href=/tags/script><i class="fas fa-tags"></i> script</a></li><li><a href=/tags/security><i class="fas fa-tags"></i> security</a></li><li><a href=/tags/soccer><i class="fas fa-tags"></i> soccer</a></li><li><a href=/tags/sports><i class="fas fa-tags"></i> sports</a></li><li><a href=/tags/web><i class="fas fa-tags"></i> web</a></li></ul></div></div></div></div></div></div><footer id=footer><div class=container><div class="col-md-4 col-sm-6"><h4>About</h4>AlpsCode is a technical blog about programming languages, tips, examples, and tech trends. Follow me at <a href=https://twitter.com/alpscode>Twitter</a> and <a href=https://github.com/alpscode>Github</a>.<hr class="hidden-md hidden-lg hidden-sm"></div><div class="col-md-4 col-sm-6"></div><div class="col-md-4 col-sm-6"><h4>Contact</h4><p>alpscode [at] gmail</p><p><a href=https://github.com/alpscode><i class='fa fa-2x fa-github'></i></a>
<a href=https://twitter.com/alpscode><i class='fa fa-2x fa-twitter'></i></a>
<a href=https://stackoverflow.com/users/10735543/alp-c><i class='fa fa-2x fa-stack-overflow'></i></a><hr class="hidden-md hidden-lg hidden-sm"></div></div></footer><div id=copyright><div class=container><div class=col-md-12><p class=pull-left><a rel=license href=http://creativecommons.org/licenses/by-sa/4.0/><img alt="Creative Commons License" style=border-width:0 src=https://i.creativecommons.org/l/by-sa/4.0/88x31.png></a>&nbsp; &nbsp;This blog is licensed under a <a rel=license href=http://creativecommons.org/licenses/by-sa/4.0/>Creative Commons Attribution-ShareAlike 4.0 International License</a>.</p><p class=pull-right>Template by <a href=http://bootstrapious.com/free-templates>Bootstrapious</a>.
Ported to Hugo by <a href=https://github.com/devcows/hugo-universal-theme>DevCows</a></p></div></div></div></div><script src=//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js integrity=sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa crossorigin=anonymous></script><script src=//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js></script><script src=//cdnjs.cloudflare.com/ajax/libs/waypoints/4.0.1/jquery.waypoints.min.js></script><script src=//cdnjs.cloudflare.com/ajax/libs/Counter-Up/1.0/jquery.counterup.min.js></script><script src=//cdnjs.cloudflare.com/ajax/libs/jquery-parallax/1.1.3/jquery-parallax.js></script><script src=https://alpscode.com/js/gmaps.init.js></script><script src=https://alpscode.com/js/front.js></script><script src=https://alpscode.com/js/owl.carousel.min.js></script><script>var myLazyLoad=new LazyLoad({elements_selector:".lazy"})</script><script src=https://d3js.org/d3.v6.min.js></script></body></html>